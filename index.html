<!doctype html>
<meta charset="utf-8">
<style type="text/css" media="screen">
  .district {
    stroke: #fff;
    stroke-width: 0.8;
    fill-opacity: 0.6;
  }

  .district:hover {
    fill-opacity: 0.8;
  }

  .county {
    fill: none;
    stroke: #333;
    stroke-width: 0.5;
    stroke-opacity: 0.6;
    shape-rendering: crispedges;
  }

  .label {
    font-family: Helvetica;
    font-size: 11px;
    font-weight: bold;
    fill-opacity: 1;
    text-anchor: middle;
    stroke: none;
  }
</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script type="text/javascript" charset="utf-8">
  var width = 960,
      height = 600

  var path = d3.geo.path()
  var color = d3.scale.category20()

  var svg = d3.select("body").append('svg')
    .attr('width', width)
    .attr('height', height)

  d3.json('us.json', function(error, us) {
    if(error) return console.error(error)

    svg.append('path')
      .datum(topojson.mesh(us, us.objects.counties))
      .attr('class', 'county')
      .attr('d', path)

    districts = svg.selectAll('.district')
      .data(topojson.feature(us, us.objects.districts).features)
    .enter().append('g')
      .attr('class', 'district')

    districts.append('path')
      .attr('d', path)
      .style('fill', function(d, i) { return color(i) })

    districts.each(function(d) {
      var center = path.centroid(d)
      d3.select(this).append('text')
        .attr('class', 'label')
        .attr('dx', function(d) { return center[0] })
        .attr('dy', function(d) { return center[1] })
        .text(d.properties.jdcode)
    })

  })
</script>
</body>
